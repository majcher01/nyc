<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="gra.js"></script>
</head>
<body>
   
    <input type="number" id="wybranepokolenie">
    <br>
    <button onclick="policzpokolenie()">Wykonaj</button>

    <div id="czysieustalilo"></div>
    <div id="wynik"></div>
    <div id="ilezywe"></div>


    <script>

    let data2=data.split("\n").map((e)=> e.trim());
    //console.log(data2);
    let pokolenie1=[];

    for(i=0;i<data2.length;i++){
        let wiersz=data2[i].split('');

        for(j=0;j<wiersz.length;j++){
            if(wiersz[j]=="."){
                wiersz[j]=0;
            }else if(wiersz[j]=="X"){
                wiersz[j]=1;
            }
        }
        pokolenie1.push(wiersz);
    }

    //console.log(pokolenie1);


        //console.log(tymczasowa);

    function policzpokolenie(){

        //check czy byl odpalany juz

        if(document.getElementById('wynik').innerHTML!=''){
            if(confirm('musisz odswiezyc strone, chcesz to zrobic?')==true){
                location.reload();
            }else{
                return 0;
            }
        }

        let wybranepokolenie=Number(document.getElementById('wybranepokolenie').value);
        //let niemogeztymbadziewiem=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        
        


        for(i=0;i<(wybranepokolenie-1);i++){//ta obraca sie tyle ile pokolen poda user
        let tymczasowa=[
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        ]
           

            for( x=0;x<pokolenie1.length;x++){
                for( y=0;y<pokolenie1[0].length;y++ ){
                    /*if(pokolenie1[x][y]==1){

                        //wspolrzednex.push([x,y]);
                    }*/
                    //console.log(pokolenie1[x][y]);



                    let sasiaddol='';
                    let sasiadgora='';
                    let sasiadlewo='';
                    let sasiadprawo='';
                    if((x-1)<0){ sasiadgora=pokolenie1.length-1 }else{sasiadgora=x-1}
                    if((x+1)>(pokolenie1.length-1)){ sasiaddol=0}else{ sasiaddol=x+1}
                    if((y-1)<0){ sasiadlewo=pokolenie1[0].length-1}else{ sasiadlewo=y-1}
                    if((y+1)>(pokolenie1[0].length-1)){ sasiadprawo=0}else{ sasiadprawo=y+1}

                    suma=pokolenie1[sasiadgora][sasiadlewo]+pokolenie1[sasiadgora][y]+pokolenie1[sasiadgora][sasiadprawo]+pokolenie1[x][sasiadlewo]+pokolenie1[x][sasiadprawo]+pokolenie1[sasiaddol][sasiadlewo]+pokolenie1[sasiaddol][y]+pokolenie1[sasiaddol][sasiadprawo];
                    //console.log("wspolrzedne: "+x+":"+y+"suma: "+suma);
                   // console.log(sasiaddol);
                  //  console.log(sasiadgora);
                   // console.log(sasiadlewo);
                 //   console.log(sasiadprawo);

                    





                    //document.getElementById('wynik').innerHTML+=pokolenie1[x][y];

                    /*
                    if(pokolenie1[x][y]==0 && suma==3){
                        temp[x][y]==1;
                        console.log("ozyla: "+x+":"+y)
                    }

                    if( (pokolenie1[x][y]==1 && suma==2) || (pokolenie1[x][y]==1 && suma==3) ){
                        temp[x][y]==1
                        console.log("Dalej zyje: "+x+":"+y)
                    }

                    if( (pokolenie1[x][y]==1 && suma!=2) || (pokolenie1[x][y]==1 && suma!=3)){
                        temp[x][y]==0;
                        console.log("umarla: "+x+":"+y)
                    }*/


                    
                    if(pokolenie1[x][y]==1){
                        if(suma==2){
                            tymczasowa[x][y]=1;
                        }else if(suma==3){
                            tymczasowa[x][y]=1;
                        }else{
                            tymczasowa[x][y]=0;
                        }
                    }else if(pokolenie1[x][y]==0){
                        if(suma==3){
                            tymczasowa[x][y]=1;
                        }
                    }
                }
               // document.getElementById('wynik').innerHTML+='<br>';
            }
            //console.log(wspolrzednex);

           // console.log(tymczasowa);

            if(tymczasowa.join()==pokolenie1.join()){

                if(document.getElementById('czysieustalilo').innerHTML==''){
                document.getElementById('czysieustalilo').innerHTML='ustalilo sie w '+(i+2)+' pokoleniu';
                }
            }

            pokolenie1=tymczasowa;

        }

        console.log(pokolenie1);
   
            let content="<table>"; 

            for(a=0;a<pokolenie1.length;a++){

                content+="<tr>";

                for(b=0;b<pokolenie1[0].length;b++){
                    
                    if( pokolenie1[a][b]==1 ){
                        content+='<td>'+"X"+'</td>';
                    }else{
                        content+='<td>'+"."+'</td>';
                    }

                }

                content+="</tr>";
            }

            content+="</table>";

            document.getElementById('wynik').innerHTML=content;
            document.getElementById('ilezywe').innerHTML='Liczba zywych w pokoleniu: '+ (pokolenie1.join()).match(/1/g).length ;


       /* console.log("po zmianach");
        console.log(tymczasowa);*/



    }
    </script>
</body>
</html>